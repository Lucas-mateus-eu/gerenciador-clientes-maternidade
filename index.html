<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de Clientes e Documentos</title>

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23191970'/><text x='28' y='65' font-family='Georgia, serif' font-size='50' fill='%23BE1E2D' font-weight='600'>R</text><text x='48' y='65' font-family='Georgia, serif' font-size='50' fill='%23FFFFFF' font-weight='600'>S</text></svg>" type="image/svg+xml">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <!-- Secção de Autenticação -->
    <div id="auth-section">
        <div class="min-h-screen bg-slate-100 flex flex-col justify-center py-12 sm:px-6 lg:px-8">
            <div class="sm:mx-auto sm:w-full sm:max-w-md text-center">
                <!-- Logótipo -->
                <div class="flex justify-center mb-4">
                   <svg class="h-32 w-auto" viewBox="0 0 250 250" xmlns="http://www.w3.org/2000/svg">
                        <rect width="250" height="250" fill="#191970"/>
                        <text x="70" y="130" font-family="Georgia, serif" font-size="100" fill="#BE1E2D" font-weight="600">R</text>
                        <text x="115" y="130" font-family="Georgia, serif" font-size="100" fill="#FFFFFF" font-weight="600">S</text>
                        <text x="52" y="170" font-family="Georgia, serif" font-size="18" fill="white" letter-spacing="4">ASSESSORIA</text>
                        <line x1="52" y1="178" x2="198" y2="178" stroke="white" stroke-width="1.5"/>
                        <text x="32" y="198" font-family="Georgia, serif" font-size="18" fill="white" letter-spacing="1.5">PREVIDENCIÁRIA</text>
                    </svg>
                </div>
                <h2 id="auth-title" class="text-3xl font-extrabold text-gray-900">
                    Login / Entrar
                </h2>
            </div>
            <div class="mt-8 sm:mx-auto sm:w-full sm:max-w-md">
                <div class="bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10">
                    <!-- Formulário de Login -->
                    <form id="login-form" class="space-y-6">
                        <div>
                            <label for="login-email" class="block text-sm font-medium text-gray-700"> Endereço de e-mail </label>
                            <div class="mt-1">
                                <input id="login-email" name="email" type="email" autocomplete="email" required class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            </div>
                        </div>
                        <div>
                            <label for="login-password" class="block text-sm font-medium text-gray-700"> Senha </label>
                            <div class="mt-1">
                                <input id="login-password" name="password" type="password" autocomplete="current-password" required class="appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                            </div>
                        </div>
                        <div>
                            <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Entrar
                            </button>
                        </div>
                    </form>
                    
                    <!-- Formulário de Registo -->
                    <form id="register-form" class="hidden space-y-6">
                        <div>
                            <label for="register-email" class="block text-sm font-medium text-gray-700"> Endereço de e-mail </label>
                            <input id="register-email" name="email" type="email" required class="mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <label for="register-password" class="block text-sm font-medium text-gray-700"> Senha (mínimo 6 caracteres) </label>
                            <input id="register-password" name="password" type="password" required class="mt-1 appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                        </div>
                        <div>
                            <button type="submit" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Criar Conta
                            </button>
                        </div>
                    </form>

                    <p id="auth-error" class="mt-2 text-center text-sm text-red-600"></p>

                    <div class="mt-6">
                        <div class="relative">
                            <div class="absolute inset-0 flex items-center">
                                <div class="w-full border-t border-gray-300"></div>
                            </div>
                            <div class="relative flex justify-center text-sm">
                                <span class="px-2 bg-white text-gray-500"> Ou </span>
                            </div>
                        </div>
                        <div class="mt-6">
                            <button id="toggle-auth-mode" class="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                                Criar uma conta nova
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Conteúdo Principal da Aplicação -->
    <div id="app-content" class="hidden">
        <div id="app" class="container mx-auto p-4 md:p-8">
            <header class="text-center mb-8 relative">
                <!-- Logótipo do Cabeçalho -->
                <div class="absolute top-0 left-0 flex items-center space-x-3">
                     <svg class="h-16 w-auto" viewBox="0 0 250 250" xmlns="http://www.w3.org/2000/svg">
                        <rect width="250" height="250" fill="#191970"/>
                        <text x="70" y="130" font-family="Georgia, serif" font-size="100" fill="#BE1E2D" font-weight="600">R</text>
                        <text x="115" y="130" font-family="Georgia, serif" font-size="100" fill="#FFFFFF" font-weight="600">S</text>
                        <text x="52" y="170" font-family="Georgia, serif" font-size="18" fill="white" letter-spacing="4">ASSESSORIA</text>
                        <line x1="52" y1="178" x2="198" y2="178" stroke="white" stroke-width="1.5"/>
                        <text x="32" y="198" font-family="Georgia, serif" font-size="18" fill="white" letter-spacing="1.5">PREVIDENCIÁRIA</text>
                    </svg>
                </div>
                <h1 class="text-3xl md:text-4xl font-bold text-slate-800">Gerenciador de Clientes e Documentos</h1>
                <p class="text-slate-500 mt-2">Adicione, edite, pesquise e gere documentos para seus clientes.</p>
                <div class="absolute top-0 right-0">
                    <span id="user-email" class="text-sm text-slate-500 mr-4"></span>
                    <button id="logout-btn" class="bg-red-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-red-600 text-sm">Sair</button>
                </div>
            </header>
            
            <div id="dashboard" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 mb-8">
                <div class="bg-blue-500 text-white p-4 rounded-lg shadow-md text-center">
                    <h3 class="text-2xl font-bold" id="total-clients">0</h3>
                    <p class="text-sm">Total de Clientes</p>
                </div>
                <div class="bg-yellow-500 text-white p-4 rounded-lg shadow-md text-center">
                    <h3 class="text-2xl font-bold" id="pending-clients">0</h3>
                    <p class="text-sm">Pendentes</p>
                </div>
                <div class="bg-indigo-500 text-white p-4 rounded-lg shadow-md text-center">
                    <h3 class="text-2xl font-bold" id="analysis-clients">0</h3>
                    <p class="text-sm">Em Análise</p>
                </div>
                <div class="bg-green-500 text-white p-4 rounded-lg shadow-md text-center">
                    <h3 class="text-2xl font-bold" id="completed-clients">0</h3>
                    <p class="text-sm">Concluídos</p>
                </div>
                 <div class="bg-orange-500 text-white p-4 rounded-lg shadow-md text-center">
                    <h3 class="text-2xl font-bold" id="total-a-receber">R$ 0,00</h3>
                    <p class="text-sm">Total a Receber</p>
                </div>
                <div class="bg-emerald-500 text-white p-4 rounded-lg shadow-md text-center">
                    <h3 class="text-2xl font-bold" id="total-recebido">R$ 0,00</h3>
                    <p class="text-sm">Total Recebido</p>
                </div>
            </div>

            <!-- Formulário para Adicionar/Editar Cliente -->
            <div id="form-section" class="bg-white p-6 rounded-lg shadow-md mb-8">
                <h2 id="form-title" class="text-2xl font-semibold text-slate-700 mb-4 border-b pb-2">Adicionar Nova Cliente</h2>
                <form id="add-client-form" class="space-y-4">
                    <input type="hidden" name="clientId">
                    <div class="form-grid">
                        <input type="text" name="nome_completo" placeholder="Nome Completo" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" required>
                        <input type="text" name="cpf" placeholder="CPF" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="14">
                        <input type="text" name="fone" placeholder="Telefone" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="15">
                        <input type="email" name="email" placeholder="E-mail" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="data_nascimento" placeholder="Data de Nascimento" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="10">
                        <input type="text" name="rg" placeholder="RG" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="12">
                        <input type="text" name="exp" placeholder="Data de Expedição (RG)" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="10">
                        <input type="text" name="profissao" placeholder="Profissão" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <select name="estado_civil" class="p-3 border rounded-md w-full bg-white focus:ring-2 focus:ring-blue-500">
                            <option value="">Estado Civil...</option>
                            <option value="solteira">Solteira</option>
                            <option value="casada">Casada</option>
                            <option value="divorciada">Divorciada</option>
                            <option value="viuva">Viúva</option>
                            <option value="separada">Separada</option>
                        </select>
                        <div id="status-wrapper" class="hidden">
                            <select name="status" class="p-3 border rounded-md w-full bg-white focus:ring-2 focus:ring-blue-500">
                                <option value="Pendente">Status: Pendente</option>
                                <option value="Em Análise">Status: Em Análise</option>
                                <option value="Concluído">Status: Concluído</option>
                            </select>
                        </div>
                        <input type="text" name="endereco" placeholder="Endereço (Rua, Av.)" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="numero" placeholder="Número" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="bairro" placeholder="Bairro" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="cidade" placeholder="Cidade" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="uf" placeholder="UF" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="2">
                        <input type="text" name="cep" placeholder="CEP" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="9">
                        <input type="text" name="nit" placeholder="NIT/PIS/PASEP" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="titulo" placeholder="Título de Eleitor" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="14">
                        <input type="text" name="nome_do_pai" placeholder="Nome do Pai" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="nome_da_mae" placeholder="Nome da Mãe" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <input type="text" name="nacionalidade" placeholder="Nacionalidade" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" value="Brasileira">
                        <input type="text" name="natural" placeholder="Naturalidade" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <select name="escola" class="p-3 border rounded-md w-full bg-white focus:ring-2 focus:ring-blue-500">
                            <option value="">Escolaridade...</option>
                            <option value="Fundamental Incompleto">Fundamental Incompleto</option>
                            <option value="Fundamental Completo">Fundamental Completo</option>
                            <option value="Médio Incompleto">Médio Incompleto</option>
                            <option value="Médio Completo">Médio Completo</option>
                            <option value="Graduação/Faculdade">Graduação/Faculdade</option>
                            <option value="Bacharelado">Bacharelado</option>
                        </select>
                        <input type="text" name="n_matricula" placeholder="Nº da Matrícula" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="39">
                        <input type="text" name="divulgador" placeholder="Divulgador" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <div class="col-span-full flex gap-4 items-center">
                            <label class="flex items-center space-x-2">
                                <input type="checkbox" name="sirc" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <span>SIRC</span>
                            </label>
                             <label class="flex items-center space-x-2">
                                <input type="checkbox" name="trava" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <span>TRAVA</span>
                            </label>
                             <label class="flex items-center space-x-2">
                                <input type="checkbox" name="sine" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <span>SINE</span>
                            </label>
                             <label class="flex items-center space-x-2">
                                <input type="checkbox" name="cnis_check" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                <span>CNIS</span>
                            </label>
                        </div>
                        
                        <h3 class="col-span-full font-semibold text-slate-600 mt-4 -mb-2 border-t pt-4">Informações de Maternidade e Trabalho</h3>
                        <input type="text" name="data_registro" placeholder="Data do Registro (Bebê)" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="10">
                        <input type="text" name="nasc_bebe" placeholder="Data de Nascimento (Bebê)" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="10">
                        <select name="saiu_gravida" class="p-3 border rounded-md w-full bg-white focus:ring-2 focus:ring-blue-500">
                            <option value="">Saiu grávida da empresa?</option>
                            <option value="sim">Sim</option>
                            <option value="nao">Não</option>
                        </select>
                        <input type="text" name="data_adim" placeholder="Data de Admissão" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="10">
                        <input type="text" name="data_demiss" placeholder="Data de Demissão" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500" maxlength="10">
                        <select name="tipo_demissao" class="p-3 border rounded-md w-full bg-white focus:ring-2 focus:ring-blue-500">
                            <option value="">Tipo de Demissão...</option>
                            <option value="pediu">Pediu demissão</option>
                            <option value="foi demitida">Foi demitida</option>
                            <option value="justa causa">Justa causa</option>
                        </select>
                        <select name="seguro_desemprego" class="p-3 border rounded-md w-full bg-white focus:ring-2 focus:ring-blue-500">
                            <option value="">Recebeu Seguro Desemprego?</option>
                            <option value="sim">Sim</option>
                            <option value="nao">Não</option>
                        </select>
                        <select name="vinculos" class="p-3 border rounded-md w-full bg-white focus:ring-2 focus:ring-blue-500">
                            <option value="">Vínculos...</option>
                            <option value="aberto">Aberto</option>
                            <option value="fechado">Fechado</option>
                        </select>
                        

                        <h3 class="col-span-full font-semibold text-slate-600 mt-4 -mb-2 border-t pt-4">Informações Financeiras</h3>
                        <input type="text" name="valor_beneficio" placeholder="Valor do Benefício (Ex: 1500,00)" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <select name="status_pagamento" class="p-3 border rounded-md w-full bg-white focus:ring-2 focus:ring-blue-500">
                            <option value="A Aguardar Pagamento">Pagamento: A Aguardar</option>
                            <option value="Pago">Pagamento: Pago</option>
                        </select>
                        
                        <h3 class="col-span-full font-semibold text-slate-600 mt-4 -mb-2 border-t pt-4">Outras Informações e Anotações</h3>
                        <input type="text" name="senha_cnis" placeholder="Senha CNIS" class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500">
                        <textarea name="new_note" placeholder="Adicionar nova anotação..." class="p-3 border rounded-md w-full focus:ring-2 focus:ring-blue-500 col-span-full" rows="3"></textarea>
                    </div>
                    <div class="flex space-x-2">
                        <button id="submit-button" type="submit" class="w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-md hover:bg-blue-700 transition duration-300 flex items-center justify-center disabled:bg-slate-400 disabled:cursor-wait">
                            Salvar Cliente
                        </button>
                        <button id="cancel-edit-btn" type="button" class="hidden w-full bg-slate-500 text-white font-bold py-3 px-4 rounded-md hover:bg-slate-600 transition duration-300">
                            Cancelar Edição
                        </button>
                    </div>
                </form>
            </div>

            <!-- Lista de Clientes -->
            <div id="clients-list-section" class="bg-white p-6 rounded-lg shadow-md">
                 <div class="flex flex-col sm:flex-row justify-between items-center mb-4 border-b pb-2">
                    <h2 class="text-2xl font-semibold text-slate-700 mb-2 sm:mb-0">Clientes Cadastradas</h2>
                    <div class="flex items-center gap-4">
                        <button id="trash-btn" class="text-slate-500 hover:text-blue-600">Ver Lixeira</button>
                        <input type="search" id="search-input" placeholder="Pesquisar por nome ou CPF..." class="p-2 border rounded-md focus:ring-2 focus:ring-blue-500 w-full sm:w-auto">
                    </div>
                 </div>
                 <div id="clients-list" class="space-y-3">
                     <p class="text-slate-500">Nenhum cliente cadastrado ainda.</p>
                 </div>
            </div>
        </div>
    </div>
    
    <!-- Modais -->
    <div id="document-modal" class="modal fixed inset-0 bg-black bg-opacity-60 hidden items-start justify-center overflow-y-auto">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl my-12 relative">
             <div class="p-4 md:p-8 no-print sticky top-0 bg-slate-50 border-b z-10 flex justify-between items-center">
                 <h3 id="modal-title" class="text-xl font-bold text-slate-800">Visualização de Documento</h3>
                 <div class="flex flex-wrap gap-2 justify-end">
                     <button id="print-btn" class="bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700">Imprimir / Salvar PDF</button>
                     <button onclick="closeModal('document-modal')" class="bg-red-600 text-white font-bold py-2 px-4 rounded-md hover:bg-red-700">&times; Fechar</button>
                 </div>
            </div>
             <div id="modal-content" class="modal-content document-preview"></div>
        </div>
    </div>
    <div id="files-modal" class="modal fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-2xl">
            <h3 id="files-modal-title" class="text-xl font-bold text-slate-800 mb-4">Anexos</h3>
            <div class="mb-4">
                <label for="file-upload" class="cursor-pointer bg-blue-100 text-blue-700 font-semibold py-2 px-4 rounded-md hover:bg-blue-200">Escolher Ficheiros</label>
                <input id="file-upload" type="file" class="hidden" multiple>
                <button id="upload-btn" class="bg-green-600 text-white font-bold py-2 px-4 rounded-md hover:bg-green-700 ml-2">Enviar</button>
            </div>
            <div id="upload-progress-container" class="w-full bg-gray-200 rounded-full h-2.5 mb-4 hidden">
                <div id="upload-progress-bar" class="bg-blue-600 h-2.5 rounded-full" style="width: 0%"></div>
            </div>
            <div id="files-list" class="space-y-2 max-h-60 overflow-y-auto">
                <p class="text-slate-500">Nenhum anexo encontrado.</p>
            </div>
            <div class="flex justify-end mt-6">
                <button onclick="closeModal('files-modal')" class="bg-slate-200 text-slate-800 font-bold py-2 px-4 rounded-md hover:bg-slate-300">Fechar</button>
            </div>
        </div>
    </div>
     <div id="trash-modal" class="modal fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-2xl">
            <h3 class="text-xl font-bold text-slate-800 mb-4">Lixeira</h3>
            <div id="trash-list" class="space-y-2 max-h-80 overflow-y-auto">
                <p class="text-slate-500">A lixeira está vazia.</p>
            </div>
            <div class="flex justify-end mt-6">
                <button onclick="closeModal('trash-modal')" class="bg-slate-200 text-slate-800 font-bold py-2 px-4 rounded-md hover:bg-slate-300">Fechar</button>
            </div>
        </div>
    </div>
    <div id="delete-confirm-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm">
            <h3 class="text-lg font-bold text-slate-800 mb-4">Confirmar Ação</h3>
            <p id="delete-confirm-text" class="text-slate-600 mb-6"></p>
            <div class="flex justify-end space-x-2">
                <button onclick="closeModal('delete-confirm-modal')" class="bg-slate-200 text-slate-800 font-bold py-2 px-4 rounded-md hover:bg-slate-300">Cancelar</button>
                <button id="confirm-delete-btn" class="bg-red-600 text-white font-bold py-2 px-4 rounded-md hover:bg-red-700">Confirmar</button>
            </div>
        </div>
    </div>
    <div id="duplicate-warning-modal" class="modal fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl p-6 w-full max-w-sm">
            <h3 class="text-lg font-bold text-slate-800 mb-4">Cliente Já Cadastrado</h3>
            <p id="duplicate-warning-text" class="text-slate-600 mb-6">Já existe um cliente cadastrado com este CPF.</p>
            <div class="flex justify-end">
                <button onclick="closeModal('duplicate-warning-modal')" class="bg-blue-600 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700">Entendido</button>
            </div>
        </div>
    </div>

    <!-- Custom JS -->
    <script type="module" src="script.js"></script>
</body>
</html>
